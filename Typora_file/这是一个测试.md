这是一个测试 22 3

![image-20251127204812633](assets/这是一个测试/image-20251127204812633.png)

123

2

2

# [基于Git为Typora附加同步功能](https://linux.do/t/topic/898933)

https://linux.do/t/topic/898933)

## 目标

- Typora配合Git脚本，通过软件启动或`F12`按键触发同步。

## 优点

- 利用Git的特点保存文件修改历史。
- 利用Git仓库的界面可以在手机端查看数据。

## 缺点

- 依赖Git。
- 有一定的提交冲突风险，会导致同步失败（手动解决即可），个人使用基本遇不到。

## 环境

- Typora 1.10.8
- Windwos 11

## 步骤

1. 笔记文件夹初始为Git仓库，可以参考教程：https://blog.csdn.net/abtain/article/details/123419766

2. 笔记文件夹下创建名为`GitSync.bat`的自动提交脚本，内容如下

   ```cmd
   @echo off
   
   cd /d "%~dp0"
   echo %cd%
   
   git pull origin main
   
   git add .
   
   git commit -m "%date% %time%"
   
   git push origin main
   ```

   注意：第一步切换为笔记文件所在目录根据实际情况调整。

3. 将下面的脚本内容存放在应用resources目录下，文件名为`typora-git.js`：

   ```js
   const {exec} = reqnode('child_process');
   
   const batFile = 'D:/Storage/Markdown/GitSync.bat';
   
   let working = false;
   
   function gitSync(e) {
       if (working) {
           return;
       }
   
       if (e.type !== 'load' && e.key !== 'F12') {
           return
       }
   
       working = true;
   
       exec(batFile, (error, stdout, stderr) => {
           working = false;
   
           if (error) {
               message(error.message);
               return;
           }
   
           if (e.key !== 'F12') {
               return;
           }
           message(stdout);
       });
   }
   
   function message(msg) {
       showDialog({message: msg});
       working = false;
   }
   
   window.addEventListener('load', gitSync);
   window.addEventListener('keydown', gitSync);
   ```

   注意：脚本内的路径调整为第2步`GitSync.bat`的具体路径，注意`/`的写法，否则路径不生效。

4. 在`Typora安装目录\resources\window.html`尾部添加脚本：

   ```js
   <script src="./typora-git.js"></script>
   ```

5. 重启Typora软件，每次启动软件或者软件启动后按下`F12`键即可同步修改到远程Git仓库。

   注意：修改成了 按下 ALT + S 同步修改
   
   谢谢！
   
   5